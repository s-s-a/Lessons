# Автоматическое переименование файлов на Python.
# Представьте ситуацию: у вас есть папка, заполненная сотнями изображений или документов.
# Их названия выглядят бессистемно, содержат лишние символы или не несут никакой полезной
# информации. Переименовывать каждый файл вручную — занятие изнурительное и крайне неэффективное.
# Python справится с этим за считанные мгновения.

# Первым делом импортируем модуль pathlib:
from pathlib import Path


# Создадим функцию rename_files(), которая и будет заниматься переименованием файлов.
# У функции будет присутствовать три параметра, а именно:
# directory — путь к директории с файлами
# old_substring — подстрока, которую нужно найти
# new_substring — подстрока, на которую нужно заменить.

def rename_files(directory: str, old_substring: str, new_substring: str) -> None:
	# Внутри неё, первым делом создадим объект Path для работы с путём к директории.
	# Далее добавим условие для проверки пути директории на существование:

	# Создаем объект Path для работы с путем к директории
	dir_path = Path(directory)

	# Проверяем, существует ли указанный путь и является ли он директорией
	if not dir_path.is_dir():
		print(f"Ошибка: '{directory}' не является директорией.")
		return

	# При помощи цикла пройдёмся по всем элементам директории. В нём будет производиться
	# проверка, является ли текущий элемент файлом и содержит ли его имя искомую подстроку.
	# Если да, то создаём новое имя файла, заменяя подстроку, также создаём новый путь к файлу
	# с обновленным именем и переименовываем его:
	# Итерируемся по всем элементам в директории
	for file_path in dir_path.iterdir():
		# Проверяем, является ли текущий элемент файлом и содержит ли его имя искомую подстроку
		if file_path.is_file() and old_substring in file_path.name:
			# Создаем новое имя файла, заменяя подстроку
			new_name = file_path.name.replace(old_substring, new_substring)
			# Создаем новый путь к файлу с обновленным именем
			new_path = file_path.with_name(new_name)
			try:
				# Пытаемся переименовать файл
				file_path.rename(new_path)
				print(f"Переименован: {file_path.name} -> {new_name}")
			except Exception as e:
				# Обрабатываем возможные ошибки при переименовании
				print(f"Ошибка при переименовании {file_path.name}: {e}")


# Добавим точку входа:
if __name__ == "__main__":
	# Пример использования:
	# Замените 'ваш/путь/к/папке' на реальный путь к папке
	rename_files(r'ваш/путь/к/папке', 'старое_слово', 'новое_слово')
