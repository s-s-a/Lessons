# –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Windows –Ω–∞ Python —á–∞—Å—Ç—å 4

# –í —Å–∫—Ä–∏–ø—Ç–∞—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ pywin32.
# ‚û°Ô∏è–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏: pip install pywin32

import os
import win32api
import win32con
import win32net
import win32netcon
import ctypes
import win32com.client

# üíª –í—ã–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ —á–µ—Ä–µ–∑ Python:

os.system("shutdown /s /t 10")  # –í—ã–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥

# üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞:

os.system("shutdown /r /t 5")  # –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥

# üñ• –°–º–µ–Ω–∞ –∏–º–µ–Ω–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞:
win32api.SetComputerName("NEW-PC-NAME")  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞

# ‚öôÔ∏è –û—Ç–∫—Ä—ã—Ç–∏–µ "–î–∏—Å–ø–µ—Ç—á–µ—Ä–∞ –∑–∞–¥–∞—á":

win32api.ShellExecute(0, "open", "taskmgr.exe", None, None, 1)

# üìÅ –°–æ–∑–¥–∞–Ω–∏–µ —è—Ä–ª—ã–∫–∞ –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ:

# –ü–æ–ª—É—á–∞–µ–º –ø—É—Ç—å –∫ —Ä–∞–±–æ—á–µ–º—É —Å—Ç–æ–ª—É —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

desktop = os.path.join(os.path.expanduser("~"), "Desktop")

# –ó–∞–¥–∞—ë–º –ø—É—Ç—å, –≥–¥–µ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω —è—Ä–ª—ã–∫

target_path = os.path.join(desktop, "–ë–ª–æ–∫–Ω–æ—Ç.lnk")

# –°–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —è—Ä–ª—ã–∫–∞–º–∏ —á–µ—Ä–µ–∑ Windows Script Host

shell = win32com.client.Dispatch("WScript.Shell")

# –°–æ–∑–¥–∞–µ–º —è—Ä–ª—ã–∫

target_shortcut = shell.CreateShortcut(target_path)

# –£–∫–∞–∑—ã–≤–∞–µ–º –ø—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É –±–ª–æ–∫–Ω–æ—Ç–∞

target_shortcut.TargetPath = "C:\\Windows\\System32\\notepad.exe"

# –°–æ—Ö—Ä–∞–Ω—è–µ–º —è—Ä–ª—ã–∫

target_shortcut.Save()


# üîç –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º:

# –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ WMI (Windows Management Instrumentation), —á—Ç–æ–±—ã –ø–æ–ª—É—á–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

wmi = win32com.client.GetObject("winmgmts:\\\\.\\root\\CIMV2")

# –í—ã–ø–æ–ª–Ω—è–µ–º WMI-–∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º

programs = wmi.ExecQuery("SELECT * FROM Win32_Product")

# –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –∏ –≤—ã–≤–æ–¥–∏–º –Ω–∞–∑–≤–∞–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º

for program in programs:
    print(program.Name)


# ‚ö°Ô∏è –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:

# –°–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç Shell.Application –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±–æ–ª–æ—á–∫–æ–π Windows

shell = win32com.client.Dispatch("Shell.Application")

# –ó–∞–ø—É—Å–∫–∞–µ–º –ë–ª–æ–∫–Ω–æ—Ç (notepad.exe) —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã ShellExecute:

# 1. "notepad.exe" ‚Äì –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª
# 2. "" ‚Äì –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (–∑–¥–µ—Å—å –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞)
# 3. "" ‚Äì —Ä–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è (–∑–¥–µ—Å—å –Ω–µ –∑–∞–¥–∞–Ω–∞)
# 4. "runas" ‚Äì –∑–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
# 5. 1 ‚Äì –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ

shell.ShellExecute("notepad.exe", "", "", "runas", 1)

# üåÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ–±–æ–µ–≤ —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞:

# –£–∫–∞–∑—ã–≤–∞–µ–º –ø—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–±–æ–µ–≤ —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞

path = "C:\\Path\\To\\Wallpaper.jpg"

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–±–æ–µ–≤ —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞ —Å –ø–æ–º–æ—â—å—é SystemParametersInfoW

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

# 1. win32con.SPI_SETDESKWALLPAPER ‚Äì —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–º–µ–Ω—É –æ–±–æ–µ–≤ —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞
# 2. 0 ‚Äì —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
# 3. path ‚Äì –ø—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é
# 4. 3 ‚Äì –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (SPIF_UPDATEINIFILE | SPIF_SENDCHANGE)

ctypes.windll.user32.SystemParametersInfoW(win32con.SPI_SETDESKWALLPAPER, 0, path, 3)


# üë• –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–∏—Å—Ç–µ–º—ã:

server = (
    None  # –£–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ–º —Å –ª–æ–∫–∞–ª—å–Ω—ã–º –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–º (–º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∏–º—è —Å–µ—Ä–≤–µ—Ä–∞)
)
level = 0  # –£—Ä–æ–≤–µ–Ω—å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö

# –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

# 1. server ‚Äì —Ü–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä (None –æ–∑–Ω–∞—á–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π)
# 2. level ‚Äì —É—Ä–æ–≤–µ–Ω—å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ (0 –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∏–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
# 3. win32netcon.FILTER_NORMAL_ACCOUNT ‚Äì —Ñ–∏–ª—å—Ç—Ä, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π, —á—Ç–æ –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ –æ–±—ã—á–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏

users, _, _ = win32net.NetUserEnum(server, level, win32netcon.FILTER_NORMAL_ACCOUNT)

# –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≤—ã–≤–æ–¥–∏–º –∏—Ö –∏–º–µ–Ω–∞

for user in users:
    print(user["name"])

# üåê –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π:

wmi = win32com.client.GetObject("winmgmts:\\\\.\\root\\CIMV2")

# –í—ã–ø–æ–ª–Ω—è–µ–º WMI-–∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –∞–¥–∞–ø—Ç–µ—Ä–æ–≤

# –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ –∞–¥–∞–ø—Ç–µ—Ä—ã, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å NetConnectionID (—Ç.–µ. –æ–Ω–∏ –∞–∫—Ç–∏–≤–Ω—ã)

adapters = wmi.ExecQuery(
    "SELECT * FROM Win32_NetworkAdapter WHERE NetConnectionID IS NOT NULL"
)

# –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ –∞–¥–∞–ø—Ç–µ—Ä—ã –∏ –≤—ã–≤–æ–¥–∏–º –∏—Ö –∏–º—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ MAC-–∞–¥—Ä–µ—Å

for adapter in adapters:
    print(f"{adapter.NetConnectionID} - {adapter.MACAddress}")

# üìÅ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ:

_, total, free = win32api.GetDiskFreeSpaceEx("C:\\")
print(f"–°–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ: {free // (1024**3)} –ì–ë –∏–∑ {total // (1024**3)} –ì–ë")

# üñ• –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞:
# –ü–æ–ª—É—á–∞–µ–º —à–∏—Ä–∏–Ω—É —ç–∫—Ä–∞–Ω–∞ –≤ –ø–∏–∫—Å–µ–ª—è—Ö (–∏–Ω–¥–µ–∫—Å 0)

width = win32api.GetSystemMetrics(0)

# –ü–æ–ª—É—á–∞–µ–º –≤—ã—Å–æ—Ç—É —ç–∫—Ä–∞–Ω–∞ –≤ –ø–∏–∫—Å–µ–ª—è—Ö (–∏–Ω–¥–µ–∫—Å 1)

height = win32api.GetSystemMetrics(1)

# –í—ã–≤–æ–¥–∏–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ "—à–∏—Ä–∏–Ω–∞ x –≤—ã—Å–æ—Ç–∞"

print(f"–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞: {width}x{height}")


# üñ• –ó–∞–ø—Ä–æ—Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ:


# –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ WMI –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

wmi = win32com.client.GetObject("winmgmts:\\\\.\\root\\CIMV2")

# –í—ã–ø–æ–ª–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ WMI –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ

cpu_info = wmi.ExecQuery("SELECT * FROM Win32_Processor")

# –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã (–æ–±—ã—á–Ω–æ –æ–¥–∏–Ω –Ω–∞ —Å–∏—Å—Ç–µ–º—É)

for cpu in cpu_info:
    # –í—ã–≤–æ–¥–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞, —á–∏—Å–ª–æ —è–¥–µ—Ä –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —á–∞—Å—Ç–æ—Ç—É
    print(
        f"–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä: {cpu.Name}, –Ø–¥–µ—Ä: {cpu.NumberOfCores}, –ß–∞—Å—Ç–æ—Ç–∞: {cpu.MaxClockSpeed} MHz"
    )
